一、主要流程如下：

1、预处理：读取并分离彩色图像的 RGB 通道。
2、密钥生成：通过哈希函数和密钥生成混沌系统的初始参数。
3、加密过程：
     生成测量矩阵（Phi）并进行 SVD 优化。
     稀疏化图像的小波系数，并进行置乱和编码。
     进行压缩感知测量和量化。
4、嵌入过程：将加密后的数据嵌入到另一张载体图像中。
5、水印提取：从嵌入后的图像中提取加密数据，并进行重构。
6、性能评估：计算重构图像与原始图像之间的 PSNR 和 SSIM，以及嵌入图像与载体图像之间的指标。


二、详细功能：

2.1 预处理部分

     图像读取与分离：读取指定路径下的彩色图像 car55.jpg，并将其转换为双精度数组。随后将图像分离为 R、G、B 三个通道。
参数初始化：
      TS: 用于稀疏化的小波系数阈值。
      r: 压缩率，决定测量矩阵的行数 M。
      daub(8): 生成 Daubechies 8 小波的滤波器系数。
      basis2d: 预定义的小波基函数数组。

2.2. 密钥生成部分

      哈希函数应用：使用 SHA-512 哈希函数对原始图像 imgOrg 进行哈希处理，生成哈希值 H。
      密钥转换：
             将十六进制密钥 KeyHex 转换为十进制形式 KeyDecimal，具体实现依赖于 HashtoDecimal 函数。
             通过一系列的按位异或（bitxor）操作，生成一个长度为 8 的密钥向量 k。
             对 k 中的每个元素进行 1/8 次方的操作，调整其值。
      混沌系统参数生成：根据 k 的值，通过平方根和模运算生成混沌映射的初始参数 a, cx0, cy0, 和 delta。

2.3. 加密过程

     2.3.1 测量矩阵生成：
             通过混沌序列生成随机数，构建稀疏测量矩阵 Phi。
             使用 Kronecker 积 (kron) 生成二维测量矩阵。
             进行 SVD 分解并优化测量矩阵，以改善其性能。
             对 Phi 的每一列进行单位化处理。
     2.3.2 小波变换与稀疏化：
             对 RGB 三个通道分别进行小波变换，得到稀疏系数 imgSp1, imgSp2, imgSp3。
             对小波系数进行阈值处理，保留绝对值大于 TS 的系数。
     2.3.3 置乱与编码：
             使用 Arnold 置乱对稀疏系数进行混沌置乱。
             通过多次 Encode 函数进一步编码数据，提高安全性。
     2.3.4 压缩感知测量与量化：
             使用测量矩阵 Phi 对编码后的数据进行线性测量，得到测量值 imgMea1, imgMea2, imgMea3。
             对测量值进行归一化和量化，转换为 8 位无符号整数。

2.4. 嵌入过程

      2.4.1 载体图像读取与展示：
              读取用于嵌入水印的载体图像 Barnfall(1).jpg。
              显示其直方图以观察像素分布。
      2.4.2 小波变换：
              对载体图像的 RGB 三个通道分别进行小波分解，得到小波系数 imgwave1, imgwave2, imgwave3。
      2.4.3 LSB 水印嵌入：
              使用 LSB_Encode 函数将加密后的数据 img_en1, img_en2, img_en3 嵌入到载体图像的 RGB 通道中，    生成嵌入水印后的图像 WatermarketImg。


2.5. 水印提取

      2.5.1 数据解码：
              从嵌入后的图像 WatermarketImg 的 RGB 通道中提取嵌入的数据 img_en1, img_en2, img_en3 通过 LSB_Decode 函数。
       2.5.2 重构过程：
              对提取的数据进行重塑和反量化，将量化后的数据恢复为原始的测量值。
              使用 SL0 算法对每一列的测量值进行稀疏重构，得到稀疏系数 imgIre1, imgIre2, imgIre3。
       2.5.3 解码与反置乱：
              通过多次 Decode 函数恢复原始的稀疏系数。
              使用 Arnold 反置乱函数 descramble_arnold 恢复稀疏系数的原始排列。
       2.5.4 小波逆变换：
               对恢复的稀疏系数进行小波逆变换，得到解密后的 RGB 通道 img_de1, img_de2, img_de3。
               将三个通道合并，生成最终的解密图像 img_de 并保存。

2.6. 性能评估与结果展示

       图像展示：显示原始图像和重建后的图像，便于直观比较。
       性能指标计算：
              rgbPSNR: 计算重建图像与原始图像之间的峰值信噪比（PSNR）。
              mssim 或 ssim: 计算重建图像与原始图像之间的结构相似性指数（SSIM）。
              同样的指标也用于评估载体图像与嵌入水印后的图像之间的变化。